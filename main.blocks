<xml xmlns="https://developers.google.com/blockly/xml"><variables><variable id="}EmIl}CXhQNID!%tAnYZ">NUM_PIXELS</variable><variable id="o8!c[k)=T-9BfDMKH1Mt">pixel_list</variable><variable id=".}}8BBT/|jZi+p=_+GtN">BRIGHTNESS</variable><variable id="(HWe*Li.gyor.Ljm/Zz%">x</variable><variable id="O)2$a,k|bcR#Dj=YwIgJ">pixels</variable><variable id="l6$0h$/3oR77%:%k0gwc">x2</variable><variable id="%^GbI*L?18^kNaq:hX7}">j</variable><variable id=".r$-94hJ!W}@6R29h2VM">DAT</variable><variable id="y5`Y.]0Qg9**LJa?B?V`">CLK</variable><variable id=",9FU;@s,9fQ[QlJAZw8q">pixel</variable><variable id="+;zhZTh}6zqS~W^o3,0-">b</variable><variable id="j+9^aZ4HweGe?b;8enN0">g</variable><variable id="6VGPcq*vv_CN+pdv(.+:">r</variable><variable id="2i[Tm7]Mja$bOJrFdEqu">x5</variable><variable id="SzRZot-n@Sg57uy3-ETh">y</variable><variable id="6J6j]NtIFa_}L5BV,|YU">x6</variable><variable id="RQ-PS=!8P7~g|Orgy`jk">y2</variable><variable id="EvXjjN%a];`]8*vP+;jH">x7</variable></variables><block type="pxt-on-start" id="l@@7~,e+e}Oo.Y4-hC;-" x="0" y="0"><statement name="HANDLER"><block type="variables_set" id="LsEN*63cj76*`:nGB:s]"><field name="VAR" id=".r$-94hJ!W}@6R29h2VM">DAT</field><comment pinned="false" h="80" w="160">to remind us which pin serves which function</comment><value name="VALUE"><shadow type="math_number" id="u+yKy}T}$2WPIjICPX+0"><field name="NUM">0</field></shadow><block type="digital_pin" id="RN,WCm*U}P0udl1BrseB"><field name="pin">DigitalPin.P1</field></block></value><next><block type="variables_set" id="Pxu4THbn{UeL#|QBr3`("><field name="VAR" id="y5`Y.]0Qg9**LJa?B?V`">CLK</field><value name="VALUE"><shadow type="math_number" id="F]W(mbe7l=61XHcbY/e{"><field name="NUM">0</field></shadow><block type="digital_pin" id="-)!CI$z!y:V5{oSvY#O4"><field name="pin">DigitalPin.P0</field></block></value><next><block type="variables_set" id="`~v(xf1{kY71yh}8nmLk"><field name="VAR" id="}EmIl}CXhQNID!%tAnYZ">NUM_PIXELS</field><comment pinned="false" h="80" w="160">number of pixels in the chain</comment><value name="VALUE"><shadow type="math_number" id="z|$iCII~tfb/fa(4t}Eg"><field name="NUM">256</field></shadow></value><next><block type="variables_set" id="2ghn]ZB!|=]vbX|vgya)"><field name="VAR" id=".}}8BBT/|jZi+p=_+GtN">BRIGHTNESS</field><comment pinned="false" h="80" w="160">default brightness setting</comment><value name="VALUE"><shadow type="math_number" id="kgtp}cT3?_?yF@lj5Gw."><field name="NUM">7</field></shadow></value><next><block type="variables_set" id=":[T]T(f$(g3}*9U}P$]3"><field name="VAR" id="O)2$a,k|bcR#Dj=YwIgJ">pixels</field><comment pinned="false" h="80" w="160">Initialize pixels list</comment><value name="VALUE"><shadow type="math_number" id="8,/oP#)Oj.L`/nxnh4Mm"><field name="NUM">0</field></shadow><block type="function_call_output" id="tAdHdFte/PGZg_06^!`R"><mutation name="init_pixels" functionid="aHwJA*1__Iy:8G}r[SLK"></mutation></block></value><next><block type="typescript_statement" id="_3xwQ|D=yc,UW}YFo|G4"><mutation xmlns="http://www.w3.org/1999/xhtml" line0="function set_pix(x: number, rr: number, gg: number, bb: number, brightness: number = null) {" line1="    if (brightness === null) {" line2="        brightness = BRIGHTNESS" line3="    } else {" line4="        brightness = Math.trunc(31.0 * brightness) &amp; 0b11111" line5="    }" line6="    " line7="    pixels[x] = [rr &amp; 0xff, gg &amp; 0xff, bb &amp; 0xff, brightness]" line8="}" numlines="9"></mutation><next><block type="typescript_statement" id="{z~i6~r=-#i=NWGQw|fh"><mutation xmlns="http://www.w3.org/1999/xhtml" line0="function set_all(r: number, g: number, b: number, brightness: number = null) {" line1="    for (let x4 = 0; x4 &lt; NUM_PIXELS; x4++) {" line2="        set_pix(x4, r, g, b, brightness)" line3="    }" line4="}" numlines="5"></mutation><next><block type="device_while" id="G_9?i6`[T]x|$(8V*G@^"><comment pinned="false" h="80" w="160">Test code and example use</comment><value name="COND"><shadow type="logic_boolean" id="mrHb9!:Y*Z2F6`%Wh@,@"><field name="BOOL">TRUE</field></shadow></value><statement name="DO"><block type="function_call" id="2ChJ*GB@l[/b)-lMG+qo"><mutation name="set_all_rand" functionid="wqf^2^U*D*-+M!~=R7@I"></mutation><comment pinned="false" h="80" w="160">all off
clear()
show()
basic.pause(1000)
on red individually
for i in range(NUM_PIXELS):
set_pix(i, 255, 0, 0)
show()
#     basic.pause(100)
set_all(255,0,0,7)
show()
# basic.pause(1000)
# all green
set_all(0,255,0,7)
show()
# basic.pause(1000)
# all blue
set_all(0,0,255,7)
show()
set_all(255,255,255,7)
show()
# basic.pause(1000)
# set_all_rand()
set_brightness_gradient()
# basic.pause(10)
show()
# basic.pause(1500)
set_brightness_inv_gradient()
# basic.pause(10)
show()
# basic.pause(1500)</comment><next><block type="function_call" id="mokw`SiFn20t[~$G4vw!"><mutation name="show" functionid="opUep.rt%UR!}dV=cg~h"></mutation></block></next></block></statement></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></statement></block><block type="function_definition" id="ht3G-)ar}s.3CcCE{m.X" x="-114" y="1020"><mutation name="init_pixels" functionid="aHwJA*1__Iy:8G}r[SLK"></mutation><field name="function_name">init_pixels</field><comment pinned="false" h="80" w="160">list of pixels
pixels = [[1,2,3,4], [1,2,3,4], [1,2,3,4]]
Initialize pixel list manually (avoiding list comprehensions)</comment><statement name="STACK"><block type="controls_repeat_ext" id="Wimk{56a3XUB}8N4gvQZ"><value name="TIMES"><shadow type="math_whole_number" id="_.Q6R)^QR~WO2$ynUNx."><field name="NUM">0</field></shadow><block type="variables_get" id="VB8%olU)Y3;U?jZc(43n"><field name="VAR" id="}EmIl}CXhQNID!%tAnYZ">NUM_PIXELS</field></block></value><statement name="DO"><block type="array_push" id="Q?7:,Z4%VnxVLga.a|5s"><value name="list"><block type="variables_get" id="|5w(8!+|zA}]`S6?RLvv"><field name="VAR" id="o8!c[k)=T-9BfDMKH1Mt">pixel_list</field></block></value><value name="value"><block type="lists_create_with" id=".C$~^*IiK]vIxcSzTe3j" inline="false"><mutation items="4" horizontalafter="3"></mutation><value name="ADD0"><shadow type="math_number" id="U_^dhqivc@VPHW~]s$iW"><field name="NUM">0</field></shadow></value><value name="ADD1"><shadow type="math_number" id="X_X)]uwLCrN_dcgF4MP{"><field name="NUM">0</field></shadow></value><value name="ADD2"><shadow type="math_number" id="9}X[bMm0;K%+:FR$MV3["><field name="NUM">0</field></shadow></value><value name="ADD3"><block type="variables_get" id="D~6$kt))Kf7DQd0+0yI#"><field name="VAR" id=".}}8BBT/|jZi+p=_+GtN">BRIGHTNESS</field></block></value></block></value></block></statement><next><block type="function_return" id="20}eV_}`Z^S`#=Y}vkg2"><mutation xmlns="http://www.w3.org/1999/xhtml" no_return_value="false"></mutation><comment pinned="false" h="80" w="160">Each pixel is a list of [R, G, B, Brightness]</comment><value name="RETURN_VALUE"><shadow type="math_number" id="L,dI[Egv3Ikd(K[O61Mv"><field name="NUM">0</field></shadow><block type="variables_get" id="c`[$]Tg@DYb0g6{zkCRY"><field name="VAR" id="o8!c[k)=T-9BfDMKH1Mt">pixel_list</field></block></value></block></next></block></statement></block><block type="function_definition" id="o}h3u]bH`V{ku}/s6f3n" x="514" y="1020"><mutation name="set_brightness" functionid="(R3KR15ndw;k)jS1E25I"><arg name="brightness" id="xqja1m4bxrobz2kedxf4io" type="number"></arg></mutation><field name="function_name">set_brightness</field><comment pinned="false" h="80" w="160">Set the brightness of all pixels - 0 - 1.</comment><value name="xqja1m4bxrobz2kedxf4io"><block type="argument_reporter_number" id="LLqkwzNw0ktf1~sBE@)M"><mutation duplicateondrag="true"></mutation><field name="VALUE">brightness</field></block></value><statement name="STACK"><block type="controls_if" id="4_iaSWT(^Bg5as?|w#s~"><value name="IF0"><shadow type="logic_boolean" id="1}J~W=%GDY9sOcN,Cn:z"><field name="BOOL">TRUE</field></shadow><block type="logic_operation" id="/ryV9`hy+AtS/eOu$uYd"><field name="OP">OR</field><value name="A"><shadow type="logic_boolean" id="Fw$437zYm=86VY}wGqfI"><field name="BOOL">TRUE</field></shadow><block type="logic_compare" id="D%wmh?WV%btrXDgoGMHl"><field name="OP">LT</field><value name="A"><shadow type="math_number" id="IB.8S4=*K7wOVs_JWOdC"><field name="NUM">0</field></shadow><block type="argument_reporter_number" id="M4pl7_,Q;es9.2Q`1/Z}"><field name="VALUE">brightness</field></block></value><value name="B"><shadow type="math_number" id="bio.e~GEZ(Ms*rwP%E0B"><field name="NUM">0</field></shadow></value></block></value><value name="B"><shadow type="logic_boolean" id="wa4.w+Sa,:2*]S.SYZ/M"><field name="BOOL">TRUE</field></shadow><block type="logic_compare" id="yt/e%}#xws/K{32-oLO_"><field name="OP">GT</field><value name="A"><shadow type="math_number" id="|~RHc4_-P7X]xG}`LMNd"><field name="NUM">0</field></shadow><block type="argument_reporter_number" id="SA-;3.KBx#sQ/dHxU#hL"><field name="VALUE">brightness</field></block></value><value name="B"><shadow type="math_number" id="@^Y`pZa(m~yW!W5FEhco"><field name="NUM">1</field></shadow></value></block></value></block></value><statement name="DO0"><block type="function_return" id="b142;6$H$OMf69`(D$LK"><mutation xmlns="http://www.w3.org/1999/xhtml" no_return_value="true"></mutation></block></statement><next><block type="pxt_controls_for" id="A~5{HuWu*9.#HU$3K!hQ"><value name="VAR"><block type="variables_get_reporter" id="gx6}R^+_R{|dcC{-bk+L"><mutation duplicateondrag="true"></mutation><field name="VAR" id="(HWe*Li.gyor.Ljm/Zz%">x</field></block></value><value name="TO"><shadow type="math_whole_number" id="RK^hNxYkbVkDY1R^5@Vv"><field name="NUM">0</field></shadow><block type="math_arithmetic" id="Gt}}Pa(^x[RYL`VB]eh5"><field name="OP">MINUS</field><value name="A"><shadow type="math_number" id="or@L?$_y3#l8O-~;)._p"><field name="NUM">0</field></shadow><block type="variables_get" id="mq{K_8NEYOjkG7P^vcAQ"><field name="VAR" id="}EmIl}CXhQNID!%tAnYZ">NUM_PIXELS</field></block></value><value name="B"><shadow type="math_number" id="FDiaFt/W@#x/=IAb,[!:"><field name="NUM">1</field></shadow></value></block></value><statement name="DO"><block type="lists_index_set" id="de6m`y/Aa)4MB}XlY@RJ"><value name="LIST"><block type="lists_index_get" id="#aV4:_xe)8l*QA{+$C{~"><value name="LIST"><block type="variables_get" id="548f*ng4]E9LVc!JEzkE"><field name="VAR" id="O)2$a,k|bcR#Dj=YwIgJ">pixels</field></block></value><value name="INDEX"><shadow type="math_number" id="hQV;YW40:)!@G,X=5e.K"><field name="NUM">0</field></shadow><block type="variables_get" id="xi{`HDO;,%10~Mnk=VeN"><field name="VAR" id="(HWe*Li.gyor.Ljm/Zz%">x</field></block></value></block></value><value name="INDEX"><shadow type="math_number" id="zZrO^jnJ2RT?s46S8jFH"><field name="NUM">3</field></shadow></value><value name="VALUE"><block type="typescript_expression" id=";/PR}aRw%:$()!#s5;pX"><field name="EXPRESSION">Math.trunc(31.0 * brightness) &amp; 0b11111</field></block></value></block></statement></block></next></block></statement></block><block type="function_definition" id="Hz7_[6I!Fz0Vyn;m3oxQ" x="-114" y="1559"><mutation name="clear" functionid=",L#j)M6gq*1:e:9B/4F#"></mutation><field name="function_name">clear</field><comment pinned="false" h="80" w="160">Clear all of the pixels</comment><statement name="STACK"><block type="pxt_controls_for" id="C=boQoW#!OI@)S98l6xz"><value name="VAR"><block type="variables_get_reporter" id="V,#[^:$${!crRQL,]);_"><mutation duplicateondrag="true"></mutation><field name="VAR" id="l6$0h$/3oR77%:%k0gwc">x2</field></block></value><value name="TO"><shadow type="math_whole_number" id=")8!4x)8Z]*ACC_SnYmCm"><field name="NUM">0</field></shadow><block type="math_arithmetic" id="LvzT}?Ije/bdL.~-d+DM"><field name="OP">MINUS</field><value name="A"><shadow type="math_number" id=";iawYS#=W!qX8|D!TH)L"><field name="NUM">0</field></shadow><block type="variables_get" id="7ze/:38r_w}gY=l[/l/a"><field name="VAR" id="}EmIl}CXhQNID!%tAnYZ">NUM_PIXELS</field></block></value><value name="B"><shadow type="math_number" id="x`aqhS=tgL+SDl@/[!.6"><field name="NUM">1</field></shadow></value></block></value><statement name="DO"><block type="pxt_controls_for" id="6pS@lj{ZBX`gdd@Vj-?("><value name="VAR"><block type="variables_get_reporter" id="Ie3Aw3D]ClCiJMsX6T$Z"><mutation duplicateondrag="true"></mutation><field name="VAR" id="%^GbI*L?18^kNaq:hX7}">j</field></block></value><value name="TO"><shadow type="math_whole_number" id="%~Y?L#$|%przWR26xlmj"><field name="NUM">0</field></shadow><block type="math_number" id="HXLIom^?j5FXt;ru.2YD"><field name="NUM">2</field></block></value><statement name="DO"><block type="lists_index_set" id="~2vv.`7E~s)ng*zD(v1`"><value name="LIST"><block type="lists_index_get" id="=t0V+tWQ!J*IWvNdLXWF"><value name="LIST"><block type="variables_get" id="):^PKycZqU6QdU#JijXY"><field name="VAR" id="O)2$a,k|bcR#Dj=YwIgJ">pixels</field></block></value><value name="INDEX"><shadow type="math_number" id="TpK2(0^0A9d:}sPL4y4q"><field name="NUM">0</field></shadow><block type="variables_get" id="C=jHDX)hJ%+=k]b[k^Lc"><field name="VAR" id="l6$0h$/3oR77%:%k0gwc">x2</field></block></value></block></value><value name="INDEX"><shadow type="math_number" id="j5f|IBk/_@_R,:Q[2QzN"><field name="NUM">0</field></shadow><block type="variables_get" id="^DD_9!X.[~#G~YN#niK("><field name="VAR" id="%^GbI*L?18^kNaq:hX7}">j</field></block></value><value name="VALUE"><shadow type="math_number" id="a~e?aN|Bq/O*R?R/!;Ig"><field name="NUM">0</field></shadow></value></block></statement></block></statement></block></statement></block><block type="function_definition" id="Jq`fT-?%XWoQzbU)|m^v" x="606" y="1559"><mutation name="write_byte" functionid="2qTOszQhBz5P%0h]#Zj["><arg name="byte" id="w1oov9a45gjw973oggd5" type="number"></arg></mutation><field name="function_name">write_byte</field><comment pinned="false" h="80" w="160"># Pulse a byte of data a bit at a time
def write_byte(byte):
bits = []
for i in range(7, -1, -1):
bits.append((byte &gt;&gt; i) &amp; 1)
for x in range(8):
pins.digital_write_pin(DAT, bits[x])
pins.digital_write_pin(CLK,1)
pins.digital_write_pin(CLK,0)
Pulse a byte of data a bit at a time (optimized)
def write_byte(byte):
for i in range(7, -1, -1):  # Send 8 bits, MSB first
pins.digital_write_pin(DAT, (byte &gt;&gt; i) &amp; 1)
pins.digital_write_pin(CLK, 1)
pins.digital_write_pin(CLK, 0)</comment><value name="w1oov9a45gjw973oggd5"><block type="argument_reporter_number" id="2IS;U]?[*NI;[7Gz[T_i"><mutation duplicateondrag="true"></mutation><field name="VALUE">byte</field></block></value><statement name="STACK"><block type="typescript_statement" id="hvHqlCTY:rNieg/@_V|{"><mutation xmlns="http://www.w3.org/1999/xhtml" line0="for (let k = 7; k &gt; -1; k += -1) {" line1="        //  MSB first" line2="        if (byte &gt;&gt; k &amp; 1) {" line3="            pins.digitalWritePin(DAT, 1)" line4="        } else {" line5="            pins.digitalWritePin(DAT, 0)" line6="        }" line7="        " line8="        pins.digitalWritePin(CLK, 1)" line9="        pins.digitalWritePin(CLK, 0)" line10="    }" numlines="11"></mutation></block></statement></block><block type="function_definition" id="n)fZO2T.%hlVYPb@?^X." x="-114" y="2162"><mutation name="eof" functionid="D-s]0rBCZbz(RpD$05@#"></mutation><field name="function_name">eof</field><comment pinned="false" h="80" w="160">Latch procedure - 36 clock pulses
def eof():
pins.digital_write_pin(DAT, 0)
for x in range(36):
pins.digital_write_pin(CLK,1)
pins.digital_write_pin(CLK,0)</comment><statement name="STACK"><block type="device_set_digital_pin" id="ykKb8riKnJQuA0Cb+V6F"><value name="name"><shadow type="digital_pin_shadow" id="S=wL`DMXwGt);4d8xD?b"><field name="pin">DigitalPin.P0</field></shadow><block type="variables_get" id="vafm]$a;!BDPn_|Cvx[G"><field name="VAR" id=".r$-94hJ!W}@6R29h2VM">DAT</field></block></value><value name="value"><shadow type="math_number_minmax" id="dbSH(N$ecvJi*ftJ4=uG"><mutation min="0" max="1" precision="0"></mutation><field name="SLIDER">0</field></shadow></value><next><block type="controls_repeat_ext" id="UlicUwiZWTud#ZmUO8m_"><value name="TIMES"><shadow type="math_whole_number" id="ls2dzR#|cg:*0kK*U0p["><field name="NUM">0</field></shadow><block type="math_js_op" id="hLe4H*[9nHu`q/NHxqay"><mutation xmlns="http://www.w3.org/1999/xhtml" op-type="infix"></mutation><field name="OP">idiv</field><value name="ARG0"><shadow type="math_number" id="Xqnt_%(iIFnC0MRYP~Yx"><field name="NUM">0</field></shadow><block type="variables_get" id=";Pe.;#+$W:qbk!!ajhba"><field name="VAR" id="}EmIl}CXhQNID!%tAnYZ">NUM_PIXELS</field></block></value><value name="ARG1"><shadow type="math_number" id="=Cu_acz2E!M3TIR5-GO2"><field name="NUM">16</field></shadow></value></block></value><statement name="DO"><block type="device_set_digital_pin" id="c9]dZJVTaco*sZdGaX$L"><comment pinned="false" h="80" w="160">Reduce unnecessary pulses</comment><value name="name"><shadow type="digital_pin_shadow" id="74Y?k3O:UP@OU8QGznVw"><field name="pin">DigitalPin.P0</field></shadow><block type="variables_get" id="rYu_K~JflboDher=0BK6"><field name="VAR" id="y5`Y.]0Qg9**LJa?B?V`">CLK</field></block></value><value name="value"><shadow type="math_number_minmax" id="{6Trwv:Z!-ad6@i]MeVq"><mutation min="0" max="1" precision="0"></mutation><field name="SLIDER">1</field></shadow></value><next><block type="device_set_digital_pin" id="ciQu873Zs?AwK%uRi8%%"><value name="name"><shadow type="digital_pin_shadow" id="?KO1i28xtsaT|#WRY-9t"><field name="pin">DigitalPin.P0</field></shadow><block type="variables_get" id="k8uxU+UK^@Lf.xnghP:k"><field name="VAR" id="y5`Y.]0Qg9**LJa?B?V`">CLK</field></block></value><value name="value"><shadow type="math_number_minmax" id="V`(_^W]?*kJh*2}?pjDz"><mutation min="0" max="1" precision="0"></mutation><field name="SLIDER">0</field></shadow></value></block></next></block></statement></block></next></block></statement></block><block type="function_definition" id="tE%Dda0jMZ9nUMl[d97_" x="389" y="2162"><mutation name="sof" functionid="*gUw`d*^QXUUYeO@?cdZ"></mutation><field name="function_name">sof</field><comment pinned="false" h="80" w="160">Latch at start - 32 clock pulses</comment><statement name="STACK"><block type="device_set_digital_pin" id="s$6qTwU8S/*eIs^Xy)|R"><value name="name"><shadow type="digital_pin_shadow" id="_NH[EPI2)2Jcl9bL{3}("><field name="pin">DigitalPin.P0</field></shadow><block type="variables_get" id="-?5|hcWV1H6Idkp(OHCx"><field name="VAR" id=".r$-94hJ!W}@6R29h2VM">DAT</field></block></value><value name="value"><shadow type="math_number_minmax" id="Lfa/RWT~(YpUK`HCoZR]"><mutation min="0" max="1" precision="0"></mutation><field name="SLIDER">0</field></shadow></value><next><block type="controls_repeat_ext" id="%uIo],HSJlAY}T*-Fa1t"><value name="TIMES"><shadow type="math_whole_number" id="6}?v0pYfRQSDc5tRP)^z"><field name="NUM">32</field></shadow></value><statement name="DO"><block type="device_set_digital_pin" id="9n4SU0Ux:hRD-Pv_5aB/"><value name="name"><shadow type="digital_pin_shadow" id=".ddKfTJt0^egMzumV..N"><field name="pin">DigitalPin.P0</field></shadow><block type="variables_get" id="0Xq.m%eZ3|K,nP-oUxq#"><field name="VAR" id="y5`Y.]0Qg9**LJa?B?V`">CLK</field></block></value><value name="value"><shadow type="math_number_minmax" id="G{.As+JF)JM2c_/J}B:("><mutation min="0" max="1" precision="0"></mutation><field name="SLIDER">1</field></shadow></value><next><block type="device_set_digital_pin" id="!FUq9+Ok:N:?/@+7@|C="><value name="name"><shadow type="digital_pin_shadow" id="o|mZwEhVthX.G]Xt/v1V"><field name="pin">DigitalPin.P0</field></shadow><block type="variables_get" id="i},NPNnIQgg;1sj/^3JU"><field name="VAR" id="y5`Y.]0Qg9**LJa?B?V`">CLK</field></block></value><value name="value"><shadow type="math_number_minmax" id="Bb;?Xj!WWC+LqlZi7b2]"><mutation min="0" max="1" precision="0"></mutation><field name="SLIDER">0</field></shadow></value></block></next></block></statement></block></next></block></statement></block><block type="function_definition" id="_P/+.Ry?39iC5]QgEaMc" x="-114" y="2541"><mutation name="show" functionid="opUep.rt%UR!}dV=cg~h"></mutation><field name="function_name">show</field><comment pinned="false" h="80" w="160">Update colour and brightness values from pixels list
Call this procedure to update the display</comment><statement name="STACK"><block type="function_call" id="vg{HbsQ:1t5^JT5GCPkb"><mutation name="sof" functionid="*gUw`d*^QXUUYeO@?cdZ"></mutation><next><block type="pxt_controls_for_of" id="]8ijmCymI2eWi-aI:$]{"><comment pinned="false" h="80" w="160">Start frame</comment><value name="VAR"><block type="variables_get_reporter" id="v@JgLl,qTK@VSq;CTBbN"><mutation duplicateondrag="true"></mutation><field name="VAR" id=",9FU;@s,9fQ[QlJAZw8q">pixel</field></block></value><value name="LIST"><block type="variables_get" id="h@2h-oan1on4S^2N)s3w"><field name="VAR" id="O)2$a,k|bcR#Dj=YwIgJ">pixels</field></block></value><statement name="DO"><block type="typescript_statement" id="R=qc~#UgzFna%tK)L6tx"><mutation xmlns="http://www.w3.org/1999/xhtml" line0="let [r, g, b, brightness] = pixel" numlines="1"></mutation><next><block type="function_call" id="6K*MRwp,+n1Ctp#Ii71A"><mutation name="write_byte" functionid="2qTOszQhBz5P%0h]#Zj["><arg name="byte" id="w1oov9a45gjw973oggd5" type="number"></arg></mutation><value name="w1oov9a45gjw973oggd5"><shadow type="math_number" id="w|P7%d[*G+YK*%4Lj{1*"><field name="NUM">1</field></shadow><block type="typescript_expression" id="6{nHD=GX9t!vY?jM]{/L"><field name="EXPRESSION">0b11100000 | brightness</field></block></value><next><block type="function_call" id="XaLI8IV#e6fNfNrGu^~k"><mutation name="write_byte" functionid="2qTOszQhBz5P%0h]#Zj["><arg name="byte" id="w1oov9a45gjw973oggd5" type="number"></arg></mutation><comment pinned="false" h="80" w="160">Brightness header</comment><value name="w1oov9a45gjw973oggd5"><shadow type="math_number" id="I{DULLua++YI%)ye#@k%"><field name="NUM">1</field></shadow><block type="variables_get" id="?Eq|`Rug5K1ywH;_+?jq"><field name="VAR" id="+;zhZTh}6zqS~W^o3,0-">b</field></block></value><next><block type="function_call" id="]fRd:eHF9AI@7V-.EmYg"><mutation name="write_byte" functionid="2qTOszQhBz5P%0h]#Zj["><arg name="byte" id="w1oov9a45gjw973oggd5" type="number"></arg></mutation><comment pinned="false" h="80" w="160">Send Blue</comment><value name="w1oov9a45gjw973oggd5"><shadow type="math_number" id="j2WNuD]X~aOd@N{m,4(R"><field name="NUM">1</field></shadow><block type="variables_get" id="ynJ4f1w1}Z3,c7ez,UP^"><field name="VAR" id="j+9^aZ4HweGe?b;8enN0">g</field></block></value><next><block type="function_call" id="U9gUyy.!%n_:(5FK[0qk"><mutation name="write_byte" functionid="2qTOszQhBz5P%0h]#Zj["><arg name="byte" id="w1oov9a45gjw973oggd5" type="number"></arg></mutation><comment pinned="false" h="80" w="160">Send Green</comment><value name="w1oov9a45gjw973oggd5"><shadow type="math_number" id="C1`+xeDLxPFT2^/Krk@S"><field name="NUM">1</field></shadow><block type="variables_get" id="dfKu._$`#:07E/-Dbr}y"><field name="VAR" id="6VGPcq*vv_CN+pdv(.+:">r</field></block></value></block></next></block></next></block></next></block></next></block></statement><next><block type="function_call" id="2Im*+xqBW)VEWy~SJK$g"><mutation name="eof" functionid="D-s]0rBCZbz(RpD$05@#"></mutation><comment pinned="false" h="80" w="160">Send Red</comment><next><block type="controls_repeat_ext" id="~JHXDkf[#/yL6UbA7Fj~"><comment pinned="false" h="80" w="160">End frame, ensuring the last pixels update properly
Extra clock pulses to ensure all data is shifted out (APA102 requirement)</comment><value name="TIMES"><shadow type="math_whole_number" id="w`*+JHvL6%0NRK~Td7A."><field name="NUM">0</field></shadow><block type="math_js_op" id="6P={lAYswg2+#Ksd52-q"><mutation xmlns="http://www.w3.org/1999/xhtml" op-type="infix"></mutation><field name="OP">idiv</field><value name="ARG0"><shadow type="math_number" id="zQz,,6S`u(e4[4/Hj`=p"><field name="NUM">0</field></shadow><block type="variables_get" id="3lnzJ{BWPEaGbR-gfgC8"><field name="VAR" id="}EmIl}CXhQNID!%tAnYZ">NUM_PIXELS</field></block></value><value name="ARG1"><shadow type="math_number" id="uyO0tH*J8Dkjzw{BD=tf"><field name="NUM">2</field></shadow></value></block></value><statement name="DO"><block type="device_set_digital_pin" id="hn}uOAGHy.y{Ur;p*g!r"><value name="name"><shadow type="digital_pin_shadow" id=";LGRXw#364qY*l9uN@ad"><field name="pin">DigitalPin.P0</field></shadow><block type="variables_get" id="U4GpTZhH#KZ.3X2aZ:GM"><field name="VAR" id="y5`Y.]0Qg9**LJa?B?V`">CLK</field></block></value><value name="value"><shadow type="math_number_minmax" id="u9W0pUGP7|E}A)^bZ,ri"><mutation min="0" max="1" precision="0"></mutation><field name="SLIDER">1</field></shadow></value><next><block type="device_set_digital_pin" id="YTLwR#ZG}`d50kK!f4sC"><value name="name"><shadow type="digital_pin_shadow" id="{D:Z5W+b54Y!5qH7u.Q|"><field name="pin">DigitalPin.P0</field></shadow><block type="variables_get" id="^R;VCwsA%d7Dhi9cEwf:"><field name="VAR" id="y5`Y.]0Qg9**LJa?B?V`">CLK</field></block></value><value name="value"><shadow type="math_number_minmax" id="E:3(:6Imfm$[;PnbQX4N"><mutation min="0" max="1" precision="0"></mutation><field name="SLIDER">0</field></shadow></value></block></next></block></statement></block></next></block></next></block></next></block></statement></block><block type="function_definition" id="=B`}@lH*xGV:2{h^7Zly" x="412" y="2541"><mutation name="set_all_rand" functionid="wqf^2^U*D*-+M!~=R7@I"></mutation><field name="function_name">set_all_rand</field><statement name="STACK"><block type="pxt_controls_for" id="fJ]y]k%%9q+?{X@CRl`R"><value name="VAR"><block type="variables_get_reporter" id="EKT|g1KQD%zH=Lsa#(h8"><mutation duplicateondrag="true"></mutation><field name="VAR" id="2i[Tm7]Mja$bOJrFdEqu">x5</field></block></value><value name="TO"><shadow type="math_whole_number" id="Q,A-(nTm){3;rJ@cYMak"><field name="NUM">0</field></shadow><block type="math_arithmetic" id="}@:7cr=+E;Cc=SYhUmX["><field name="OP">MINUS</field><value name="A"><shadow type="math_number" id="QV5shjC-u9pno[TX3#NG"><field name="NUM">0</field></shadow><block type="variables_get" id="-z;)?9_0R[dODpt~3hIq"><field name="VAR" id="}EmIl}CXhQNID!%tAnYZ">NUM_PIXELS</field></block></value><value name="B"><shadow type="math_number" id="7?QUS?JGbd-rYJLSZ^z5"><field name="NUM">1</field></shadow></value></block></value><statement name="DO"><block type="typescript_statement" id="@mcLVpW@Hb/O9`ylYjPS"><mutation xmlns="http://www.w3.org/1999/xhtml" line0="set_pix(x5, randint(0, 255), randint(0, 255), randint(0, 255), randint(0, 255))" numlines="1"></mutation></block></statement></block></statement></block><block type="function_definition" id="!sT}Nn@9Y(?]m`q*EE2k" x="-114" y="3288"><mutation name="set_brightness_gradient" functionid="6@6lKQQ!gs/b*@=4(MOF"></mutation><field name="function_name">set_brightness_gradient</field><statement name="STACK"><block type="pxt_controls_for" id="*xLwJ+CNh)d.x_)AA3F$"><value name="VAR"><block type="variables_get_reporter" id="sIHaCdq^w5ylWdxK@1w*"><mutation duplicateondrag="true"></mutation><field name="VAR" id="SzRZot-n@Sg57uy3-ETh">y</field></block></value><value name="TO"><shadow type="math_whole_number" id="5]^9@nzi~@.|hw*+;%I~"><field name="NUM">0</field></shadow><block type="math_number" id="%As7Kw/fUEi@hzjW7r/*"><field name="NUM">15</field></block></value><statement name="DO"><block type="pxt_controls_for" id="B+[NYIfL(;.[vi?Psjx,"><value name="VAR"><block type="variables_get_reporter" id="tK%.irB1VMfhG;o2:b4q"><mutation duplicateondrag="true"></mutation><field name="VAR" id="6J6j]NtIFa_}L5BV,|YU">x6</field></block></value><value name="TO"><shadow type="math_whole_number" id="9rWqS2J3E4VB%]~!DEu1"><field name="NUM">0</field></shadow><block type="math_number" id=")f#TX1)r`_Gc5svgVO5W"><field name="NUM">15</field></block></value><statement name="DO"><block type="typescript_statement" id="Xa$j}UrdfS@f`V;4F-sM"><mutation xmlns="http://www.w3.org/1999/xhtml" line0="set_pix(y * 16 + x6, 255, 255, 255, Math.abs(7.5 - y) / 8.)" numlines="1"></mutation></block></statement></block></statement></block></statement></block><block type="function_definition" id="tMy:x,IYp{0Qk[b+5Fb[" x="549" y="3288"><mutation name="set_brightness_inv_gradient" functionid=")91uXGvbwDSS(=wn?SU_"></mutation><field name="function_name">set_brightness_inv_gradient</field><statement name="STACK"><block type="pxt_controls_for" id="9P-4i+Ajy440EfYLpR1^"><value name="VAR"><block type="variables_get_reporter" id=":{bd#Y^K!;6A@C=:@-Y~"><mutation duplicateondrag="true"></mutation><field name="VAR" id="RQ-PS=!8P7~g|Orgy`jk">y2</field></block></value><value name="TO"><shadow type="math_whole_number" id="*do4~~h1nx,/n#R*rIag"><field name="NUM">0</field></shadow><block type="math_number" id="RR$WB59#tJEB$Sb#M_Y,"><field name="NUM">15</field></block></value><statement name="DO"><block type="pxt_controls_for" id="x1sZsRu)xi7:~Q^O5M^B"><value name="VAR"><block type="variables_get_reporter" id="WzJGrf1SAIG54u28HB,v"><mutation duplicateondrag="true"></mutation><field name="VAR" id="EvXjjN%a];`]8*vP+;jH">x7</field></block></value><value name="TO"><shadow type="math_whole_number" id="SvMS+_9k7aTKFpzeF5vE"><field name="NUM">0</field></shadow><block type="math_number" id="Sv3sy!%?avK2`d{ZX@/n"><field name="NUM">15</field></block></value><statement name="DO"><block type="typescript_statement" id="L#`J[!3GDN%4}=.JI4sl"><mutation xmlns="http://www.w3.org/1999/xhtml" line0="set_pix(y2 * 16 + x7, 255, 255, 255, 1.0 - Math.abs(7.5 - y2) / 8.)" numlines="1"></mutation></block></statement></block></statement></block></statement></block></xml>